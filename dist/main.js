!function(){"use strict";const e=e=>{const t=document.querySelector(".how-to-play"),l=document.querySelector(".game"),n=window.innerWidth;switch(e.target.innerHTML){case"Home":default:t.style.transition="transform 0.5s ease-in-out",t.style.transform=`translateX(${-n}px)`,l.style.transition="transform 0.5s ease-in-out",l.style.transform="translateX(0px)";break;case"How To Play":t.style.transition="transform 0.5s ease-in-out",t.style.transform=`translateX(${n}px)`,l.style.transition="transform 0.5s ease-in-out",l.style.transform=`translateX(${n}px)`;break;case"Source Code":console.log("Source Code")}},t=(e,t,l)=>{const n=document.createElement("div");return n.className="ship",n.id="drag"+e,n.setAttribute("data-length",t),n.setAttribute("draggable",!0),n.style.width=l,n},l=e=>{const t=document.createElement("div");return t.className="ship-sub-div",t.style.width="32px",t.style.height="32px",t.setAttribute("data-div",e),t},n=(e,t,l,n)=>{if(t>4||t<1)throw new Error("Wrong Length");return{shipName:e,shipLength:t,direction:l,group:n,array:[...Array(t)],hit(e){if(e>=this.array.shipLength||e<0)throw new Error("Wrong Position");this.array[e]="hit"},isSink(){return this.array.every((e=>"hit"===e))}}},a=()=>Math.floor(10*Math.random()),o=()=>Math.floor(10*Math.random()),r=()=>{let e=Math.floor(2*Math.random());return 0===e?"horizontal":1===e?"vertical":void 0},d=()=>({board:[[null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null]],placeShip(e,t,l,n){let r=!0;if("horizontal"===n){console.log("horizontal");for(let n=0;n<l.shipLength;n++)console.log("checking available",e,t+n," for ship ",l),console.log("10",this.board[e][10]),(null!==this.board[e][t+n]&&this.board[e][t+n]!==l||void 0===this.board[e][t+n])&&(r=!1);if(r){console.log("placed!"),this.board[e][t]=l;for(let n=0;n<l.shipLength;n++)this.board[e][t+n]=l}else r||(console.log("random!"),this.placeShip(a(),o(),l,n))}else if("vertical"===n){console.log("vertical");for(let n=0;n<l.shipLength;n++)console.log("checking available",e+n,t," for ship ",l),e+l.shipLength-1>9?(console.log("Out of range!"+e+l.shipLength-1),r=!1):(null!==this.board[e+n][t]&&this.board[e+n][t]!==l||void 0===this.board[e+n][t])&&(r=!1);if(r){console.log("placed!"),this.board[e][t]=l;for(let n=0;n<l.shipLength;n++)this.board[e+n][t]=l}else r||(console.log("random!"),this.placeShip(a(),o(),l,n));console.log(this.board)}},removeShip(e,t,l,n){if("horizontal"===n)for(let n=0;n<l.shipLength;n++)this.board[e][t+n]=null;else if("vertical"===n)for(let n=0;n<l.shipLength;n++)this.board[e+n][t]=null},receiveAttack(e,t){"ship"===this.board[e][t]||"object"==typeof this.board[e][t]&&null!=this.board[e][t]?this.board[e][t]="hit":null===this.board[e][t]&&(this.board[e][t]="missed")},isMiss(e,t){return"missed"===this.board[e][t]},isHit(e,t){return"hit"===this.board[e][t]},isAllShipSink(){return!this.board.some((e=>e.some((e=>"object"==typeof e&&null!==e||"ship"===e))))},hitCount(){let e=0;for(let t=0;t<this.board.length;t++)for(let l=0;l<this.board[t].length;l++)"hit"===this.board[t][l]&&e++;return e}}),i=e=>({name:e}),c=(e,t,l)=>{if(!0===l)return;let n=Number(e.srcElement.parentElement.parentElement.attributes[1].value),a=Number(e.srcElement.parentElement.parentElement.attributes[2].value),o=t.board[n][a],r=Number(e.srcElement.parentElement.dataset.length),d=32*r+r-1,i=!0;if("horizontal"===o.direction){for(let e=1;e<o.shipLength;e++)null===t.board[n+e][a]&&void 0!==t.board[n+e][a]||(i=!1);if(console.log(i),!1===i)return;e.srcElement.parentElement.style.flexDirection="column",e.srcElement.parentElement.style.width="32px",e.srcElement.parentElement.style.height=d+"px",t.removeShip(n,a,o,"horizontal"),t.placeShip(n,a,o,"vertical"),o.direction="vertical"}else if("vertical"===o.direction){for(let e=1;e<o.shipLength;e++)null===t.board[n][a+e]&&void 0!==t.board[n][a+e]||(i=!1);if(console.log(i),!1===i)return;e.srcElement.parentElement.style.flexDirection="row",e.srcElement.parentElement.style.width=d+"px",e.srcElement.parentElement.style.height="32px",t.removeShip(n,a,o,"vertical"),t.placeShip(n,a,o,"horizontal"),o.direction="horizontal"}},s=(e,t)=>{console.log(e),!0!==t&&(e.dataTransfer.setData("target",e.target.id),e.dataTransfer.setData("target-length",e.target.dataset.length),e.dataTransfer.setData("srcX",e.srcElement.parentElement.attributes[1].value),e.dataTransfer.setData("srcY",e.srcElement.parentElement.attributes[2].value))},p=(e,t)=>{!0!==t&&(console.log("dragover"),e.preventDefault(),e.dataTransfer.dropEffect="move")},h=(e,t,l,n)=>{if(console.log("drop"),!0===l)return;e.preventDefault();let a=e.dataTransfer.getData("target"),o=e.dataTransfer.getData("target-length"),r=Number(e.dataTransfer.getData("srcX")),d=Number(e.dataTransfer.getData("srcY")),i=Number(e.target.dataset.x),c=Number(e.target.dataset.y);if(isNaN(i)||isNaN(c))return;let s=t.board[r][d],p=!0;if("horizontal"===s.direction){for(let e=0;e<o;e++)(null!==t.board[i][c+e-n+1]&&t.board[i][c+e-n+1]!==s||void 0===t.board[i][c+e-n+1])&&(p=!1);if(console.log(p),!p)return;p&&(2==n?(i=e.target.dataset.x,c=e.target.dataset.y-1):3==n?(i=e.target.dataset.x,c=e.target.dataset.y-2):4==n&&(i=e.target.dataset.x,c=e.target.dataset.y-3),document.querySelector(`.battle-cell-content.battle-cell-content__player[data-x="${i}"][data-y="${c}"]`).appendChild(document.getElementById(a)),t.removeShip(r,d,s,"horizontal"),t.placeShip(i,c,s,"horizontal"),console.log(t.board))}else if("vertical"===s.direction){for(let e=0;e<o;e++)(null!==t.board[i+e-n+1][c]&&t.board[i+e-n+1][c]!==s||void 0===t.board[i+e-n+1][c])&&(p=!1);if(console.log(p),!p)return;p&&(2==n?(i=e.target.dataset.x-1,c=e.target.dataset.y):3==n?(i=e.target.dataset.x-2,c=e.target.dataset.y):4==n&&(i=e.target.dataset.x-3,c=e.target.dataset.y),document.querySelector(`.battle-cell-content.battle-cell-content__player[data-x="${i}"][data-y="${c}"]`).appendChild(document.getElementById(a)),t.removeShip(r,d,s,"vertical"),t.placeShip(i,c,s,"vertical"),console.log(t.board))}},u=(e,t,l,n,r,d,i)=>{if(l.isHit(e,t)||l.isMiss(e,t))u(a(),o(),l,n,r,d);else{l.receiveAttack(e,t);let a=document.querySelector(`[class$="battle-cell-content battle-cell-content__player"][data-x="${e}"][data-y="${t}"]`),o=a.innerHTML;const d=document.querySelector(".result");if(l.isHit(e,t))if(console.log("x",e,"y",t),o){var c=document.createElement("div");c.style.backgroundColor="red",c.style.position="absolute",c.style.top="0",c.style.width="100%",c.style.height="100%",c.style.zIndex="10",c.innerHTML="X",a.appendChild(c)}else a.style.position="relative",a.innerHTML="X",a.style.zIndex="3",a.style.backgroundColor="red";else l.isMiss(e,t)&&(a.innerHTML="。");l.isAllShipSink()?(d.innerHTML="Bot won!",document.getElementById("start-btn").innerHTML="Restart",document.getElementById("start-btn").onclick=()=>{window.location.reload()}):n.turn=r.name}};let m=!1;(()=>{const t=document.createElement("header"),l=document.createElement("a");l.href="#",l.onclick=t=>{e(t)};const n=document.createElement("h2");n.className="site-name",n.innerHTML="<span>B</span><span>a</span><span>t</span><span>t</span><span>l</span><span>e</span><span>s</span><span>h</span><span>i</span><span>p</span>",document.body.prepend(t),t.appendChild(l),l.appendChild(n);const a=document.createElement("nav"),o=document.createElement("ul"),r=document.createElement("li"),d=document.createElement("a");d.href="#home",d.onclick=t=>{e(t)};const i=document.createTextNode("Home");d.appendChild(i),r.appendChild(d),o.appendChild(r);const c=document.createElement("li"),s=document.createElement("a");s.href="#how-to-play",s.onclick=t=>{e(t)};const p=document.createTextNode("How To Play");s.appendChild(p),c.appendChild(s),o.appendChild(c);const h=document.createElement("li"),u=document.createElement("a");u.href="https://github.com/williamphk/odin_Battleship";const m=document.createTextNode("Source Code");u.appendChild(m),h.appendChild(u),o.appendChild(h),t.appendChild(a),a.appendChild(o)})(),(()=>{const e=document.createElement("main");document.getElementsByTagName("header")[0].after(e),(()=>{const e=document.createElement("div");e.className="how-to-play";const t=window.innerWidth;e.style.position="absolute",e.style.left=-t+"px";const l=document.createElement("h3"),n=document.createElement("h3"),a=document.createElement("h3"),o=document.createTextNode("Gameplay"),r=document.createTextNode("Game Rules"),d=document.createTextNode("Controls"),i=document.createElement("ol");i.className="gameplay-list",i.style.paddingLeft="40px";const c=document.createElement("li"),s=document.createElement("li"),p=document.createElement("li"),h=document.createElement("li"),u=document.createElement("li"),m=document.createTextNode("The game board consists of a 10x10 grid where you and the Bot will place your battleships and attempt to sink each other's ships."),b=document.createTextNode("You have a fleet of 10 ships: one 4-cell ship, two 3-cell ships, three 2-cell ships, and four 1-cell ships. The Bot also has the same fleet."),y=document.createTextNode("You will arrange your ships on the board to where you want them to be, either vertically or horizontally."),g=document.createTextNode("Once all ships are placed, you and the Bot will take turns to fire at each other's ships by clicking on a cell on the board. If you hit a ship, the cell will turn red. If you miss, nothing will happen."),f=document.createTextNode("The game ends when all the cells of a ship are hit, and the player who sinks all the opponent's ships wins.");i.appendChild(c),i.appendChild(s),i.appendChild(p),i.appendChild(h),i.appendChild(u),c.appendChild(m),s.appendChild(b),p.appendChild(y),h.appendChild(g),u.appendChild(f);const C=document.createElement("ul");C.className="game-rules-list",C.style.paddingLeft="40px";const E=document.createElement("li"),x=document.createElement("li"),S=document.createElement("li"),v=document.createTextNode("You cannot place your ships diagonally or overlap them."),N=document.createTextNode("You cannot change the position of your ships once the game has started."),T=document.createTextNode("You cannot fire at the same cell twice.");C.appendChild(E),C.appendChild(x),C.appendChild(S),E.appendChild(v),x.appendChild(N),S.appendChild(T);const z=document.createElement("ul");z.className="controls-list",z.style.paddingLeft="40px";const w=document.createElement("li"),_=document.createElement("li"),L=document.createElement("li");w.innerHTML="<kbd>Drag</kbd> and <kbd>Drop</kbd> the ships on the board",_.innerHTML="Single <kbd>Click</kbd> to rotate them",L.innerHTML="press <kbd>Start</kbd> and try to defeat the Bot! Good luck!",z.appendChild(w),z.appendChild(_),z.appendChild(L),l.appendChild(o),n.appendChild(r),a.appendChild(d),e.appendChild(l),e.appendChild(i),e.appendChild(n),e.appendChild(C),e.appendChild(a),e.appendChild(z),document.querySelector("main").appendChild(e)})(),(()=>{const e=document.createElement("div");e.className="game",e.style.display="flex",e.style.flexDirection="column",e.style.alignItems="center",e.style.gap="20px";const n=document.createElement("h3");n.className="result",e.appendChild(n);const a=document.createElement("div");a.className="battlefields";const o=document.createElement("div"),r=document.createElement("div"),d=document.createElement("h2"),i=document.createElement("h2");d.innerHTML="Your board",i.innerHTML="Enemy's board",o.appendChild(d),r.appendChild(i),a.appendChild(o),a.appendChild(r);const c=document.querySelector("main");e.appendChild(a),c.appendChild(e),o.className="player-battlefield",r.className="bot-battlefield";const s=document.createElement("table"),p=document.createElement("table");console.log(s,p),s.className="battlefield-table-container__player",p.className="battlefield-table-container__bot",o.appendChild(s),r.appendChild(p);for(let e=0;e<10;e++){const t=document.createElement("tr"),l=document.createElement("tr");t.className="battiefield-row__player",l.className="battiefield-row__bot",s.appendChild(t),p.appendChild(l);for(let n=0;n<10;n++){const a=document.createElement("td"),o=document.createElement("td");a.className="battlefield-cell",o.className="battlefield-cell";const r=document.createElement("div"),d=document.createElement("div");r.className="battle-cell-content battle-cell-content__player",d.className="battle-cell-content battle-cell-content__bot",r.dataset.x=e,r.dataset.y=n,d.dataset.x=e,d.dataset.y=n,t.appendChild(a),l.appendChild(o),a.appendChild(r),o.appendChild(d)}}const h=t(1,1,"32px"),u=t(2,1,"32px"),m=t(3,1,"32px"),b=t(4,1,"32px"),y=t(5,2,"65px"),g=t(6,2,"65px"),f=t(7,2,"65px"),C=t(8,3,"98px"),E=t(9,3,"98px"),x=t(10,4,"131px"),S=l(1),v=l(1),N=l(1),T=l(1),z=l(1),w=l(2),_=l(1),L=l(2),k=l(1),M=l(2),q=l(1),H=l(2),A=l(3),B=l(1),D=l(2),I=l(3),$=l(1),Y=l(2),X=l(3),P=l(4);h.appendChild(S),u.appendChild(v),m.appendChild(N),b.appendChild(T),y.appendChild(z),y.appendChild(w),g.appendChild(_),g.appendChild(L),f.appendChild(k),f.appendChild(M),C.appendChild(q),C.appendChild(H),C.appendChild(A),E.appendChild(B),E.appendChild(D),E.appendChild(I),x.appendChild($),x.appendChild(Y),x.appendChild(X),x.appendChild(P),document.querySelector('.battle-cell-content.battle-cell-content__player[data-x="0"][data-y="0"]').appendChild(h),document.querySelector('.battle-cell-content.battle-cell-content__player[data-x="0"][data-y="3"]').appendChild(u),document.querySelector('.battle-cell-content.battle-cell-content__player[data-x="0"][data-y="6"]').appendChild(m),document.querySelector('.battle-cell-content.battle-cell-content__player[data-x="0"][data-y="9"]').appendChild(b),document.querySelector('.battle-cell-content.battle-cell-content__player[data-x="2"][data-y="1"]').appendChild(y),document.querySelector('.battle-cell-content.battle-cell-content__player[data-x="2"][data-y="7"]').appendChild(g),document.querySelector('.battle-cell-content.battle-cell-content__player[data-x="3"][data-y="4"]').appendChild(f),document.querySelector('.battle-cell-content.battle-cell-content__player[data-x="6"][data-y="1"]').appendChild(C),document.querySelector('.battle-cell-content.battle-cell-content__player[data-x="6"][data-y="6"]').appendChild(E),document.querySelector('.battle-cell-content.battle-cell-content__player[data-x="8"][data-y="3"]').appendChild(x);const W=document.createElement("button");W.className="start-btn",W.id="start-btn",W.textContent="Start",e.appendChild(W)})()})(),(()=>{const e=document.createElement("footer"),t=document.createElement("p"),l=document.createTextNode(`© ${(new Date).getFullYear()}, William Poon`);t.appendChild(l),e.appendChild(t),document.querySelector("main").after(e)})();let b=!1;const y=n("ship1",1,"horizontal","player"),g=n("ship2",1,"horizontal","player"),f=n("ship3",1,"horizontal","player"),C=n("ship4",1,"horizontal","player"),E=n("ship5",2,"horizontal","player"),x=n("ship6",2,"horizontal","player"),S=n("ship7",2,"horizontal","player"),v=n("ship8",3,"horizontal","player"),N=n("ship9",3,"horizontal","player"),T=n("ship10",4,"horizontal","player"),z=n("ship1",1,"horizontal","bot"),w=n("ship2",1,"horizontal","bot"),_=n("ship3",1,"horizontal","bot"),L=n("ship4",1,"horizontal","bot"),k=n("ship5",2,"horizontal","bot"),M=n("ship6",2,"horizontal","bot"),q=n("ship7",2,"horizontal","bot"),H=n("ship8",3,"horizontal","bot"),A=n("ship9",3,"horizontal","bot"),B=n("ship10",4,"horizontal","bot");let D=d(),I=d();console.log(D),console.log(I),I.placeShip(a(),o(),z,r()),I.placeShip(a(),o(),w,r()),I.placeShip(a(),o(),_,r()),I.placeShip(a(),o(),L,r()),I.placeShip(a(),o(),k,r()),I.placeShip(a(),o(),M,r()),I.placeShip(a(),o(),q,r()),I.placeShip(a(),o(),H,r()),I.placeShip(a(),o(),A,r()),I.placeShip(a(),o(),B,r()),D.placeShip(0,0,y,"horizontal"),D.placeShip(0,3,g,"horizontal"),D.placeShip(0,6,f,"horizontal"),D.placeShip(0,9,C,"horizontal"),D.placeShip(2,1,E,"horizontal"),D.placeShip(2,7,x,"horizontal"),D.placeShip(3,4,S,"horizontal"),D.placeShip(6,1,v,"horizontal"),D.placeShip(6,6,N,"horizontal"),D.placeShip(8,3,T,"horizontal"),console.log(D.board);let $=i("Player"),Y=i("Bot");console.log($);const X={turn:$.name};document.querySelectorAll(".battle-cell-content__bot").forEach(((e,t)=>{e.addEventListener("click",(()=>((e,t,l,n,r,d,i,c)=>{if(!l)return;if(n.turn===c.name)return;if("。"===e.innerHTML)return;if(m)return;const s=document.querySelectorAll(".battle-cell-content__bot"),p=document.querySelector(".result");r.receiveAttack(s[t].dataset.x,s[t].dataset.y),r.isHit(s[t].dataset.x,s[t].dataset.y)?(e.innerHTML="X",e.style.backgroundColor="red"):r.isMiss(s[t].dataset.x,s[t].dataset.y)&&(e.innerHTML="。"),r.isAllShipSink()?(p.innerHTML="You won!",m=!0):(n.turn=c.name,u(a(),o(),d,n,i,r,m))})(e,t,b,X,I,D,$,Y)))}));let P=null;const W=document.querySelectorAll(".ship-sub-div");for(let e=0;e<W.length;e++)W[e].addEventListener("mouseover",(e=>{P=e.target.getAttribute("data-div"),console.log(P)}));const G=document.querySelectorAll(".ship");for(let e=0;e<G.length;e++)G[e].addEventListener("click",(e=>c(e,D,b))),G[e].addEventListener("dragstart",(e=>s(e,b))),G[e].addEventListener("dragend",(e=>{}));const R=document.querySelectorAll(".battlefield-cell");for(let e=0;e<R.length;e++)R[e].addEventListener("dragover",(e=>p(e,b))),R[e].addEventListener("drop",(e=>h(e,D,b,P)));document.getElementById("start-btn").onclick=()=>{document.getElementById("start-btn").innerHTML="Restart",document.getElementById("start-btn").onclick=()=>{window.location.reload()},document.querySelectorAll(".battlefield-cell").forEach((e=>{e.style.borderTop="0.5px solid rgb(0, 38, 255)",e.style.borderLeft="0.5px solid rgb(0, 38, 255)",e.style.backgroundColor="rgb(228, 228, 228)"})),b=!0}}();